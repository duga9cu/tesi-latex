	\chapter{Array microfonici  }
	\label{sec:array}
	Nell'evoluzione delle tecniche di riproduzione di un ambiente acustico, si è giunti a livelli di spazializzazione notevoli che rendono l'ascolto molto più coinvolgente.
	Basti pensare alla diffusione della stereofonia negli anni '60 fino a quello che è ormai uno standard \emph{de facto} della riproduzione audio domestica o cinematografica: il \emph{Surround~5.1}.
	Esistono anche molte altre tecniche avanzate di riproduzione sonora in grado di avvicinarsi a una simulazione realistica del campo acustico, almeno nel punto di ascolto, quali lo \emph{stereo dipolo binaurale} o la \emph{Wave Field Synthesis} ma non è questa la sede per approfondire tale tema.
	
	Ciò che si vuole sottolineare invece è che la ricerca in campo di registrazione ha portato allo studio di tecniche sempre più innovative per l'acquisizione del campo acustico nei più fini dettagli, quali definizione spaziale, direttività e composizione del segnale.
	
	Inizialmente per creare la sensazione di definizione spaziale si utilizzava una tecnica semplice di \emph{panning} che consiste nel processare il segnale registrato in modo da \emph{proiettare} il suono su uno o sull'altro altoparlante. 
	Parallelamente si sono fatti esperimenti di registrazione multicanale in modo da mantenere il rapporto~1:1 tra canali registrati e numero di altoparlanti, al fine di evitare il \emph{post-processing} e quindi di modificare il segnale originale.
		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FIGURA surround %%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{figure}
	  \centering
	  \includegraphics[width =8cm]{img/INA-5.png}
	  \caption{Tecniche di registrazione con array discreti di tipo INA-5\\}
	  \label{fig:INA-5}
	\end{figure}
		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FIGURA surround %%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{figure}
	  \centering
	  \includegraphics[width =8cm]{img/OCT.pdf}
	  \caption{Tecniche di registrazione con array discreti di tipo OCT surround\\}
	  \label{fig:OCT}
	\end{figure}
	
	Si vogliono citare al riguardo gli schemi \emph{INA-5} e \emph{OCT-surround}, riportati rispettivamente in figura~\ref{fig:INA-5} e figura~\ref{fig:OCT}.
	Il successo di tali array risultò essere molto limitato a causa del fatto che queste tecniche non consentono un controllo in fase di registrazione; inoltre gli array forniscono un angolo di ripresa fissato non regolabile a meno di complesse strutture snodate e non danno buoni risultati in termini di missaggio dei segnali captati a breve distanza. \\
	
	Un'alternativa innovativa rispetto a queste topologie venne proposta da Michael Gerzon and Peter Craven,   che nel 1978 lanciarono sul mercato il microfono \emph{SoundField\textsuperscript{\texttrademark}}. 
		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FIGURA soundfield %%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{figure}
	  \centering
	  \includegraphics[width =8cm]{img/soundfield.png}
	  \caption{Il microfono \emph{SoundField\textsuperscript{\texttrademark}} di Gerzon e Craven\\}
	  \label{fig:soundfield}
	\end{figure}
	Si tratta di un array di 4 capsule cardioidi disposte sulle facce di un tetraedro regolare come mostrato nella foto in figura~\ref{fig:soundfield}.
	
	L'approccio innovativo di tale microfono fu quello di scindere completamente i concetti di registrazione e riproduzione acquisendo dei segnali che modellassero il campo acustico nelle sue caratteristiche di pressione ma anche di velocità; solo la combinazione di questi segnali avrebbe dato luogo a informazioni acustiche significative.
	Questo approccio costituisce la base della codifica \emph{Ambisonics} inventata dallo stesso Peter Craven che rappresenta tutt'oggi un importante riferimento per la ricerca su impianti audio moderni.
	Secondo questa teoria, i quattro segnali registrati dalle capsule del sensore tetraedrico, vengono denominati \emph{A-format} e da essi, con un processo matematico teorizzato nella teoria \emph{Ambisonics}, è possibile ottenere quattro segnali che caratterizzano in prima approssimazione il campo vettoriale acustico nel punto in cui è posta la sonda:
	\begin{itemize}
	  \item il segnale omnidirezionale di pressione ($W$),
	  \item i tre segnali direzionali di velocità lungo i tre assi cartesiani ($X$, $Y$ e $Z$).
	\end{itemize}
	Questi segnali così elaborati vengono chiamati \emph{B-format}.
	Essi costituiscono le armoniche di ordine 0 e 1 della codifica \emph{Ambisonics} e sono indipendenti dalla conformazione dell'array utilizzato; la caratterizzazione \emph{B-format} è diventata quindi uno standard per rappresentare l'informazione acquisita dagli array microfonici avanzati.\\
	
	Oggi esistono nuove topologie di array, dal numero di microfoni molto più elevato e dalle disposizioni più disparate, in grado di sintetizzare armoniche \emph{Ambisonics} di ordine superiore al primo il cui diagramma polare è riportato in figura~\ref{fig:ambisonics}.
		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FIGURA soundfield %%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{figure}
	  \centering
	  \includegraphics[width =14cm]{img/ambisonics.png}
	  \caption{Diagramma polare delle armoniche \emph{Ambisonics}\\}
	  \label{fig:ambisonics}
	\end{figure}
	
	Combinando tra loro un set di segnali codificati in formato \emph{Ambisonics} (\emph{B-format}), attraverso un opportuno decoder che opera un semplice missaggio, è possibile ricreare un segnale equivalente a quello registrato da un microfono virtuale con orientazione arbitraria e direttività di ordine massimo pari all’ordine di troncamento del set di armoniche utilizzato.\footnote{ Vedi il capitolo~\ref{sec:virtmikes} sulla sintesi dei microfoni virtuali.}
	
	Nel presente capitolo verranno presentati i tre diversi tipi di array microfonici presi in considerazione e sui quali questa tesi è stata collaudata.
	\begin{description}
	  \item[Sferico:]  \eigen \emph{EM32} prodotto dalla \emph{mhAcoustics}\footnote{ http://www.mhacoustics.com/mh\_acoustics/Eigenmike\_microphone\_array.html.}
	  \item[Cilindrico:] array progettato dal gruppo di Acustica dell'Università degli Studi di Parma sull'hardware dell'array sferico \eigen \emph{EM32} ma con alcune aggiunte di progetto.
	  \item[Planare:] progettato dal gruppo di acustica nel 2009 e migliorato negli anni con alcune modifiche sostanziali. \\
	\end{description}
	
	
	
	
	
	
	
	\section{Array sferico: \eigen \emph{EM32}}
	\label{sec:eigenmike}
		Si tratta del primo array microfonico ad elevato grado di integrazione utilizzato dall'Università di Parma, grazie ad un progetto di collaborazione con il Centro Ricerche RAI di Torino; viene prodotto dalla società americana \emph{mhAcoustic}\footnote{ www.mhacoustics.com} ed è probabilmente il primo sistema così portatile della sua categoria ad essere stato commercializzato.\\
		
		 
		\subsection{Composizione del sistema}
		\label{sec:eigensystem}
		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FIGURA sistema eigen %%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{figure}
	  \centering
	  \includegraphics[width =14.5cm]{img/eigensystem.png}
	  \caption{Struttura del sistema \eigen \emph{EM32}\\}
	  \label{fig:eigensystem}
	\end{figure}
		Come possiamo notare dalla figura~ \ref{fig:eigensystem}, il sistema \eigen \emph{EM32} viene fornito dalla casa produttrice \emph{mhAcoustic} composto da un array microfonico sferico a 32 capsule e da una interfaccia di controllo \emph{Eigenmike Interface Box (EMIB)}, i quali devono venire interfacciati attraverso il software corredato, con un computer che si occuperà di salvare su hard disk le sessioni di registrazione dell'array.
	
	L'array microfonico è costituito da una sfera di alluminio anodizzato con raggio di 42 mm sulla cui superficie sono disposte in modo relativamente uniforme 32 capsule di tipo \emph{electret} di elevata qualità.
	La conoscenza della disposizione precisa delle capsule è di grande importanza al fine di mappare queste ultime su una proiezione dello sfondo, come verrà spiegato al capitolo \ref{sec:MAAdlg}.
	
		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FIGURA capsules eigen %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
  \centering
  \includegraphics[width =14.5cm]{img/eigencapsules.png}
  \caption{Disposizione delle capsule dell'array microfonico \eigen \emph{EM32}\\}
  \label{fig:eigencapsules}
\end{figure}
	
	Possiamo intenderne il preciso assetto dall'osservazione della figura~ \ref{fig:eigencapsules}.
	All’interno della sfera sono alloggiati l’intera circuiteria analogica di preamplificazione con guadagno controllabile via software, nonché i convertitori A/D in grado di campionare i segnali delle capsule con risoluzione fino a $24\, bit$ e frequenza di campionamento di 48\,000~Hz.
	I segnali vengono quindi trasferiti all’interfaccia \emph{EMIB} mediante un collegamento digitale garantendo l'immunità ai disturbi e con grande guadagno in comodità, ingombro e risparmio di cablaggi audio XLR.
	Lo stesso sistema di preamplificazione analogica consente anche di compensare le differenze di sensibilità esistenti tra una capsula e l'altra per ottenere scostamenti compresi tra $\pm0.5$~dB. 
	La mhAcoustics caratterizza infatti la sensibilità delle capsule una a una, e fornisce all'acquirente un file di testo contenente i 32 valori che corrispondono ai guadagni in dB necessari alla compensazione.
	Questi valori, una volta caricati sulla EEPROM contenuta all'interno del microfono stesso, vengono automaticamente sommati ad ogni variazione del guadagno in modo da effettuare la compensazione di sensibilità in modo totalmente trasparente. 
		
		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FIGURA normaISO2631  %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
  \centering
  \includegraphics[width =6cm]{img/normaISO2631.png}
  \caption{Angoli di riferimento e loro direzioni relative per la descrizione sferica rispetto al sistema di riferimento antropometrico secondo la norma ISO2631. \\}
  \label{fig:normaISO2631}
\end{figure}
	
	Al fine di effettuare la mappatura delle capsule ricercata, sono necessarie le coordinate sferiche descritte dagli angoli di \emph{azimut} e \emph{elevation}.
	Per questa descrizione si è fatto riferimento alla norma ISO2631 che viene descritta nella figura~ \ref{fig:normaISO2631}.\\
	
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TABELLA coordinate sferiche %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}[tp]
  \centering
    \scalebox{0.8}{
  \begin{tabular}{r | r r | r r}
    \emph{mic \#} & \emph{ $\theta$ $[rad]$} & \emph{$\varphi$ $[rad]$} & \emph{ $\theta$ $[^{o}]$} & \emph{$\varphi$ $[^{o}]$} \\
    \hline
    1           			& $ 0,000$	&$0,367$		&$0$		&$21$ \\
    2           			& $ 0,559$	&$0,000$		&$32$		&$0$ \\
    3           			& $ 0,000$	&$-0,367$	&$0$		&$-21$ \\
    4           			& $ 5,725$	&$0,000$		&$328$		&$0$ \\
    5           			& $ 0,000$	&$1.012$		&$0$		&$58$ \\
    6           			& $ 0,785$	&$0,611$		&$45$		&$35$ \\
    7           			& $ 1,204$	&$0,000$		&$69$		&$0$ \\
    8           			& $ 0,785$	&$-0,611$	&$45$		&$-35$ \\
    9           			& $ 0,000$	&$-1,012$	&$0$		&$-58$ \\
    10           		& $ 5,498$	&$-0,611$		&$315$		&$-35$ \\
    11         			& $ 5,079$	&$0,000$		&$291$		&$0$ \\
    12         			& $ 5,498$	&$0,611$		&$315$		&$35$ \\
    13         			& $ 1,588$	&$1,204$		&$91$		&$69$ \\
    14         			& $ 1,571$	&$0,559$		&$90$		&$32$ \\
    15         			& $ 1,571$	&$-0,541$		&$90$		&$-31$ \\
    16         			& $ 1,553$	&$-1,204$		&$89$		&$-69$ \\
    17         			& $ 3,142$	&$0,367$		&$180$		&$21$ \\
    18         			& $ 3,700$	&$0,000$		&$212$		&$0$ \\
    19         			& $ 3,142$	&$-0,367$		&$180$		&$-21$ \\
    20         			& $ 2,583$	&$0,000$		&$148$		&$0$ \\
    21		         		& $ 3,142$	&$1,012$		&$180$		&$58$ \\
    22     			& $ 3,927$	&$0,611$		&$225$		&$35$ \\
    23       			& $ 4,346$	&$0,000$		&$249$		&$0$ \\
    24       			& $ 3,927$	&$-0,611$		&$225$		&$-35$ \\
    25       			& $ 3,142$	&$-1,012$		&$180$		&$-58$ \\
    26       			& $ 2,356$	&$-0,611$		&$135$		&$-35$ \\
    27       			& $ 1,937$	&$0,000$		&$111$		&$0$ \\
    28       			& $ 2,356$	&$0,611$		&$135$		&$35$ \\
    29       			& $ 4,695$	&$1,204$		&$269$		&$69$ \\
    30       			& $ 4,712$	&$0,559$		&$270$		&$32$ \\
    31       			& $ 4,712$	&$-0,559$		&$270$		&$-32$ \\
    32       			& $ 4,730$	&$-1,204$		&$271$		&$-69$ \\
 
  \end{tabular}
  }
  \caption{Coordinate sferiche antropometriche delle direzioni delle capsule fornite sia in gradi che in radianti secondo la norma ISO2631 descritta in figura~ \ref{fig:normaISO2631} \\}
  \label{tab:capsulescoord}
\end{table}




	
	
	\subsection{Limiti intrinseci teorici del sistema}
	\label{eigenlimits}
	Per la morfologia dell'oggetto \emph{array di microfoni} in questione è possibile calcolare alcuni limiti operativi intrinseci e confrontarli con quelli dichiarati dalla casa produttrice.
	
	In primo luogo, secondo il \emph{teorema di Shannon}, dovrebbe verificarsi un fenomeno di \emph{aliasing spaziale} se si tentassero di decodificare segnali di una frequenza maggiore di quella limite. 
	Per poter essere decodificata correttamente, infatti, un'onda sonora di lunghezza d'onda $\lambda$, dovrebbe essere campionata \emph{nello spazio} un numero doppio di volte rispetto alla frequenza dell'onda che si vuole campionare.
	Si può quindi scrivere una relazione che lega la massima frequenza decodificabile prima dell'introduzione di effetti di \emph{aliasing}, che chiameremo $f_{alias}$, con la distanza di campionamento, cioè la distanza minima tra le capsule $d$, che è funzione dell'angolo tra le capsule $\gamma$ e il raggio $R$ della sfera, e quindi anche del numero di capsule del microfono:
	\begin{equation}
	\label{eq:eigenalias}
	f_{alias}=\frac{v}{2\cdot \lambda} = \frac{v}{2\cdot d} \approx \frac{v}{2\cdot R \cdot \gamma}\; \;, \; \\
\end{equation}
	essendo $v$ la velocità del suono.\\
	
	Osservando la disposizione delle capsule descritta in tabella \ref{tab:capsulescoord} si può notare che ci sono due possibili spaziature angolari fra le capsule, abbastanza simili tra loro:\\
\begin{equation} 
\left\{
\begin{aligned}
& \gamma_{1-5}=1,012-0,367 = 0,645  \\
& \gamma_{1-3}=0,367-(-0,367) = 0,734
\end{aligned}
\right.
\end{equation}\\
	dove $\gamma_{1-5}$ rappresenta la spaziatura tra le capsule 1 e 5 mentre $\gamma_{1-3}$ tra quelle contrassegnate dai numeri 1 e 3.\\
	
	Sostituendo queste spaziature nella equazione \ref{eq:eigenalias},\\
	
	\begin{equation} 
\left\{
\begin{aligned}
& f_{alias\;1-5} \approx \frac{v}{2\cdot R \cdot \gamma_{1-5}} = \frac{343}{2 \cdot 42 \cdot 10^{-3} \cdot 0,645} = 6,3\;[kHz] \\
& f_{alias\;1-3} \approx \frac{v}{2\cdot R \cdot \gamma_{1-3}} = \frac{343}{2 \cdot 42 \cdot 10^{-3} \cdot 0,734} = 5,6\;[kHz]
\end{aligned}
\right.
\end{equation}\\

	Quindi la massima frequenza operativa sembra essere intorno ai 5,5 kHz. 
	Tuttavia è bene precisare che tale relazione è valida sotto precise semplificazioni geometriche e quindi solamente per array lineari uniformi.
	La banda passante dichiarata dal costruttore, invece, è dell'ordine dei 10 kHz, quindi ampiamente superiore al valore appena calcolato.
	
	Un’altra importante relazione emerge dalla scomposizione del campo sonoro in serie di 
\emph{Fourier-Bessel} e consente di stimare il massimo ordine ($L$) delle armoniche \emph{Ambisonic} ottenibili da un microfono sferico con $N$ capsule. 
\begin{equation}
	\label{eq:eigenbressel}
		(L+1)^2 \le N\\
	\end{equation}
	
	dalla quale deriva, essendo il numero di ordine delle armoniche strettamente non negativo,
	\begin{equation}
		L \le \sqrt{ N} - 1 = \sqrt{32}-1=4,7	\\
	\end{equation}
	
	Risulta quindi che il sensore è in grado di generare microfoni virtuali supercardioidi con direttività fino al $4^{\circ}$ ordine, mentre la casa costruttrice ha impostato il sistema per la generazione di microfoni virtuali fino alla massima direttività del $3^{\circ}$ ordine.\\
	




\section{Altri array}
	Esistono altre topologie di array avanzati di cui in questo capitolo si fornirà una breve descrizione e si elencheranno le principali differenze con l'array sferico appena descritto.\\
	
	
	
	\subsection{Array lineari}
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FIGURA array lineare  %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
  \centering
  \includegraphics[width =10cm]{img/lineare.png}
  \caption{Array lineare e relativo diagramma polare a 1 kHz\\}
  \label{fig:lineare}
\end{figure}
	Gli array lineari sono i più semplici e i più diffusi dal punto di vista commerciale.
	I loro utilizzi sono plurimi e diversificati, dall'individuazione di sorgenti sonore alle misure acustiche attraverso la sintesi di un microfono virtuale ultradirettivo lungo l'asse dell'array. 
	La disposizione lineare però produce inevitabilmente una risposta spaziale dell’array non isotropa che non consente quindi di ottenere una ricostruzione precisa del campo sonoro tridimensionale.\\
	
	
	
	
		\subsection{Array planari}
			%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FIGURA array planare  %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
  \centering
  \includegraphics[width =10cm]{img/planare.png}
  \caption{Array planare e relativa mappa acustica che rappresenta i livelli sonori crescenti dal blu al rosso e in cui si riconosce una sorgente sonora come addensamento di rosso\\}
  \label{fig:planare}
\end{figure}
	Gli array planari hanno un campo di ripresa sonora di circa 180° sia sul piano orizzontale che verticale e sono indicati soprattutto per ottenere immagini sonore tipo \emph{acoustic camera}, utili nell'analisi rumoristica generalmente in ambito industriale.
	Questa topologia consente di ottenere focalizzazioni della direttività su una griglia rettangolare di punti disposti frontalmente rispetto al pannello. 
	Il modello planare costruito dal gruppo di Acustica del Dipartimento di Ingegneria Industriale dell’Università degli studi di Parma, presenta una disposizione delle capsule secondo una spirale logaritmica modificata: questa figura geometrica dovrebbe portare a una risoluzione acustica migliore rispetto alla disposizione delle capsule casuale. \\

	
	
	
		\subsection{Array cilindrici}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FIGURA array cilindrico  %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
  \centering
  \includegraphics[width =10cm]{img/cilindrico.png}
  \caption{Array cilindrico (a), con relativa sezione verticale (b)\\}
  \label{fig:cilindrico}
\end{figure}
	Questo tipo di array si pone l'obiettivo di scansionare principalmente l'asse orizzontale a scapito della risoluzione sull'asse verticale, un po' a immagine e somiglianza della naturale percezione dell'apparato acustico umano e di conseguenza anche più utile nella maggioranza delle applicazioni.
	L'array cilindrico fornisce quindi la possibilità di sintetizzare microfoni virtuali a direttività arbitraria con una zona di puntamento e focalizzazione di 360° sul piano orizzontale e di circa 90° sul piano verticale ($\pm$45° dall’orizzonte). 
	L'array costruito dal gruppo di ricerca sopraccitato è inoltre dotato di una telecamera IP che, puntando ad uno specchio per visione omnidirezionale, consente di avere un’immagine di servizio da utilizzarsi come background per la mappa acustica o per il sistema di puntamento real-time dei microfoni virtuali.\footnote{ Si tratta di un progetto parallelo di cui è consultabile una pubblicazione \cite{livevirtmikes} della società di acustica AIDA srl di Parma in collaborazione con la RAI} 